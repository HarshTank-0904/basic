untitled
===================================================================
ADMIN SETTINGS PAGE (THEME + FONT CUSTOMIZATION)
MVC STRUCTURE â€” PHP + MYSQLi + AJAX
====================================================================

1. PURPOSE
-----------
This feature allows the Admin to customize:
âœ” Color theme (choose from 6 palettes)
âœ” Font style (choose from 4 fonts)
âœ” Live preview on settings page (temporary)
âœ” Save theme and font in database (permanent)
âœ” Applied globally using header.php

====================================================================
2. FOLDER STRUCTURE (MVC)
====================================================================
project_root/
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ db.php
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â””â”€â”€ SettingsController.php
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ Settings.php
â”‚   â””â”€â”€ views/
â”‚       â””â”€â”€ settings/
â”‚           â”œâ”€â”€ settings.php
â”‚           â””â”€â”€ settings.js
â”‚
â”œâ”€â”€ includes/
â”‚   â””â”€â”€ header.php  â†’ Loads applied theme/font from DB
â”‚
â””â”€â”€ index.php       â†’ Main entry point (routes)

====================================================================
3. DATABASE TABLE
====================================================================

CREATE TABLE settings (
  id INT AUTO_INCREMENT PRIMARY KEY,
  primary_color VARCHAR(20),
  secondary_color VARCHAR(20),
  accent_color VARCHAR(20),
  font_family VARCHAR(50)
);

Insert one default row:
INSERT INTO settings (primary_color, secondary_color, accent_color, font_family)
VALUES ('#1A1A1A', '#E50914', '#FFFFFF', 'Arial, sans-serif');

====================================================================
4. MODEL FILE â€” app/models/Settings.php
====================================================================
<?php
class Settings {
    private $conn;
    public function __construct($db) {
        $this->conn = $db;
    }

    public function getSettings() {
        $result = $this->conn->query("SELECT * FROM settings LIMIT 1");
        return $result->fetch_assoc();
    }

    public function updateSettings($primary, $secondary, $accent, $font) {
        $stmt = $this->conn->prepare("UPDATE settings SET primary_color=?, secondary_color=?, accent_color=?, font_family=? WHERE id=1");
        $stmt->bind_param("ssss", $primary, $secondary, $accent, $font);
        return $stmt->execute();
    }
}
?>

====================================================================
5. CONTROLLER FILE â€” app/controllers/SettingsController.php
====================================================================
<?php
class SettingsController {
    public function index() {
        include 'config/db.php';
        include 'app/models/Settings.php';
        $model = new Settings($conn);
        $settings = $model->getSettings();
        include 'app/views/settings/settings.php';
    }

    public function update() {
        include 'config/db.php';
        include 'app/models/Settings.php';
        $model = new Settings($conn);

        $data = json_decode(file_get_contents("php://input"), true);
        $ok = $model->updateSettings($data['primary'], $data['secondary'], $data['accent'], $data['font']);
        echo json_encode(["success" => $ok]);
    }
}
?>

====================================================================
6. VIEW FILE â€” app/views/settings/settings.php
====================================================================
<?php include 'includes/header.php'; ?>

<div id="settings-page" style="padding:20px;">
    <h2>ğŸ›  Theme & Font Settings</h2>

    <h3>ğŸ¨ Choose Color Palette</h3>
    <div id="color-palettes" style="display:flex; flex-wrap:wrap; gap:20px;">
        <?php
        $palettes = [
            ['#1A1A1A','#E50914','#FFFFFF'],
            ['#2D2F36','#00B4D8','#CAF0F8'],
            ['#181818','#BB86FC','#03DAC5'],
            ['#F8F9FA','#007BFF','#343A40'],
            ['#101820','#FEE715','#FFFFFF'],
            ['#22223B','#4A4E69','#9A8C98']
        ];
        $i = 0;
        foreach ($palettes as $p):
        ?>
        <div class="palette" data-primary="<?= $p[0] ?>" data-secondary="<?= $p[1] ?>" data-accent="<?= $p[2] ?>"
             style="border:1px solid #ccc; padding:10px; cursor:pointer;">
            <div style="background:<?= $p[0] ?>;height:20px;"></div>
            <div style="background:<?= $p[1] ?>;height:20px;"></div>
            <div style="background:<?= $p[2] ?>;height:20px;"></div>
            <button class="preview-btn" data-id="<?= $i ?>">Preview</button>
        </div>
        <?php $i++; endforeach; ?>
    </div>

    <h3 style="margin-top:30px;">ğŸ…° Choose Font Style</h3>
    <div id="fonts">
        <?php
        $fonts = ['Arial, sans-serif', 'Poppins, sans-serif', 'Courier New, monospace', 'Georgia, serif'];
        foreach ($fonts as $f):
        ?>
        <div style="margin-bottom:10px;">
            <p style="font-family:<?= $f ?>;">Sample text in <?= $f ?></p>
            <button class="font-preview" data-font="<?= $f ?>">Preview Font</button>
        </div>
        <?php endforeach; ?>
    </div>

    <button id="apply-settings" style="margin-top:20px;">ğŸ’¾ Apply Settings</button>
</div>

<script src="app/views/settings/settings.js"></script>

====================================================================
7. JAVASCRIPT (AJAX + PREVIEW) â€” app/views/settings/settings.js
====================================================================
const page = document.getElementById("settings-page");
let selected = { primary: null, secondary: null, accent: null, font: null };

document.querySelectorAll(".preview-btn").forEach(btn => {
    btn.addEventListener("click", e => {
        const parent = e.target.closest(".palette");
        selected.primary = parent.dataset.primary;
        selected.secondary = parent.dataset.secondary;
        selected.accent = parent.dataset.accent;
        applyPreview();
    });
});

document.querySelectorAll(".font-preview").forEach(btn => {
    btn.addEventListener("click", e => {
        selected.font = e.target.dataset.font;
        applyPreview();
    });
});

function applyPreview() {
    if (selected.primary) page.style.background = selected.primary;
    if (selected.secondary) page.style.color = selected.secondary;
    if (selected.font) page.style.fontFamily = selected.font;
}

document.getElementById("apply-settings").addEventListener("click", () => {
    if (!selected.primary || !selected.font) {
        alert("Please select a color and a font before applying!");
        return;
    }

    fetch("index.php?controller=settings&action=update", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(selected)
    })
    .then(r => r.json())
    .then(res => {
        if (res.success) alert("Theme updated successfully!");
        else alert("Error saving settings.");
    });
});

====================================================================
8. HEADER FILE â€” includes/header.php
====================================================================
<?php
include 'config/db.php';
include 'app/models/Settings.php';
$model = new Settings($conn);
$theme = $model->getSettings();
?>
<style>
body {
    background: <?= $theme['primary_color'] ?>;
    color: <?= $theme['accent_color'] ?>;
    font-family: <?= $theme['font_family'] ?>;
}
a, h1, h2, h3, button {
    color: <?= $theme['secondary_color'] ?>;
}
button {
    background: <?= $theme['secondary_color'] ?>;
    color: #fff;
    border: none;
    padding: 8px 12px;
    cursor: pointer;
}
</style>

====================================================================
9. CONTROLLER ROUTING (index.php)
====================================================================
<?php
$controller = $_GET['controller'] ?? 'settings';
$action = $_GET['action'] ?? 'index';

if ($controller === 'settings') {
    include 'app/controllers/SettingsController.php';
    $ctrl = new SettingsController();
    if ($action === 'index') $ctrl->index();
    if ($action === 'update') $ctrl->update();
}
?>

====================================================================
10. FEATURE SUMMARY
====================================================================
âœ” Admin can pick 1 of 6 color palettes (3 shades each)  
âœ” Admin can preview theme live (only changes settings page)  
âœ” Admin can preview fonts instantly  
âœ” â€œApplyâ€ saves the theme permanently in database (via AJAX)  
âœ” New color/font automatically applies to all pages (through header.php)  
âœ” Uses MVC separation (Model, Controller, View) for maintainability  

====================================================================
11. FUTURE IMPROVEMENTS
====================================================================
- Add â€œReset to Defaultâ€ button  
- Store admin-wise preferences (if multiple admins)  
- Add live preview for all pages using localStorage  
- Allow uploading custom fonts  
- Store dark/light mode toggle in settings table  

====================================================================
END OF SETTINGS PAGE IMPLEMENTATION (MVC + AJAX)
====================================================================
